# Telegram AI Moderator Bot

Telegram-–±–æ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä —Å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —á–∞—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã—Ö –ø—Ä–∞–≤–∏–ª.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Runtime**: Bun
- **Language**: TypeScript
- **Framework**: Nuxt 3 (SSR + API —Ä–æ—É—Ç—ã)
- **Frontend**: Vue 3 + Composition API
- **Logging**: Pino + pino-pretty
- **AI**: OpenAI GPT-4
- **Database**: MongoDB (—Å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π –¥–ª—è –ª–µ–≥–∫–æ–π —Å–º–µ–Ω—ã)
- **UI**: Tailwind CSS

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
bun install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:
```bash
cp .env.example .env
```

### 3. –ó–∞–ø—É—Å–∫ MongoDB
```bash
docker-compose up -d
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è webhook)

Telegram —Ç—Ä–µ–±—É–µ—Ç HTTPS URL –¥–ª—è webhook. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –∏–ª–∏ localtunnel:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: ngrok
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
# Windows (—Å –ø–æ–º–æ—â—å—é chocolatey)
choco install ngrok

# macOS
brew install ngrok

# Linux
# –°–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/download

# –ó–∞–ø—É—Å–∫
ngrok http 3000
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: localtunnel (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
npm install -g localtunnel

# –ó–∞–ø—É—Å–∫
lt --port 3000
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env:
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ URL –æ—Ç ngrok –∏–ª–∏ localtunnel
BASE_URL=https://abc123.ngrok.io
# –∏–ª–∏
BASE_URL=https://abc123.loca.lt
```

### 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
bun run dev
```

### 6. –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:3000

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tg-moderator-ai/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ core/              # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ database/          # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/        # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/  # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ seed.ts        # –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ types/             # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ pages/                 # Vue —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îú‚îÄ‚îÄ components/            # Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ layouts/               # –ú–∞–∫–µ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
‚îî‚îÄ‚îÄ public/                # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/bots
2. –ù–∞–∂–º–∏—Ç–µ "Add Bot"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **Bot ID**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
   - **Name**: –Ω–∞–∑–≤–∞–Ω–∏–µ –±–æ—Ç–∞
   - **Token**: —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
   - **Chats**: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–æ–≤

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Ç–æ–≤

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ —É–∫–∞–∂–∏—Ç–µ:
- **Chat ID**: ID —á–∞—Ç–∞ –≤ Telegram
- **Name**: –Ω–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞
- **Rules**: –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- **Warnings before ban**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –±–∞–Ω–∞
- **Auto delete violations**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000/config/rules
2. –ù–∞–∂–º–∏—Ç–µ "Add Rule"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - **ID**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
   - **Name**: –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞
   - **Description**: –æ–ø–∏—Å–∞–Ω–∏–µ
   - **AI Prompt**: –ø—Ä–æ–º–ø—Ç –¥–ª—è AI –∞–Ω–∞–ª–∏–∑–∞
   - **Severity**: –≤–∞–∂–Ω–æ—Å—Ç—å (low/medium/high)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI –ø—Ä–æ–º–ø—Ç–∞

AI –ø—Ä–æ–º–ø—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —á–µ—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:

```
–û–ø—Ä–µ–¥–µ–ª–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–ø–∞–º–æ–º.
–ö—Ä–∏—Ç–µ—Ä–∏–∏: –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, —Ä–µ–∫–ª–∞–º–∞ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.
–û—Ç–≤–µ—Ç—å: YES/NO —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º.
```

## API Endpoints

### –ë–æ—Ç—ã
- `GET /api/bots` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–æ—Ç–æ–≤
- `POST /api/bots` - —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞
- `GET /api/bots/[id]` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ
- `PUT /api/bots/[id]` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

### –ü—Ä–∞–≤–∏–ª–∞
- `GET /api/config/rules` - —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª
- `PUT /api/config/rules` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

### –ú–æ–¥–µ—Ä–∞—Ü–∏—è
- `GET /api/moderation/logs` - –ª–æ–≥–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Pino –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

- **INFO**: –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- **ERROR**: –æ—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- **WARN**: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

–õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t tg-moderator .

# –ó–∞–ø—É—Å–∫
docker run -p 3000:3000 --env-file .env tg-moderator
```

### Production

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MongoDB
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   bun run build
   bun run start
   ```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [SPEC.md](.docs/SPEC.md)
- Issues: GitHub Issues
- –û–±—Å—É–∂–¥–µ–Ω–∏—è: GitHub Discussions
